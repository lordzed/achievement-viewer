<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Achievement viewer</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <button id="hub-button">Open Hub</button>
    <div class="container">
        <header>
            <h1>üéÆ Achievement viewer</h1>
        </header>

        <div id="info" class="info" style="display: none;">
            <h3>üìÅ Folder Structure:</h3>
        <p>Place each game's achievement file (<code>achievements.json</code> or <code>&lt;game-appid&gt;.db</code>)</p>
        <p>in the respective AppId folder at <code>AppID/&lt;game-appid&gt;/</code> on the <code>user</code> branch</p>
            <p style="margin-top: 10px;">The page will automatically scan all folders in the AppID directory!</p>
        </div>

        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <div>Scanning AppID folders...</div>
        </div>

        <div id="summary" style="display: none;"></div>
        <div id="results"></div>
        <div id="detail-view" class="game-detail-view"></div>
    </div>

    <script type="module">
        import { init } from './js/GameLoader.js';
        import { 
            displayGames, 
            showGameDetail, 
            hideGameDetail, 
            setSortMode, 
            setGridSortMode,
            handleDeepLink 
        } from './js/GameRenderer.js';
        
        // Expose functions to window for onclick handlers
        window.showGameDetail = showGameDetail;
        window.hideGameDetail = hideGameDetail;
        window.setSortMode = setSortMode;
        window.setGridSortMode = setGridSortMode;
        
        // Initialize on page load
        init().then(() => {
            displayGames();
            handleDeepLink(); // Ellen≈ërzi az URL-t bet√∂lt√©skor
        });

        // B√∂ng√©sz≈ë vissza/el≈ëre gombjainak kezel√©se
        window.addEventListener('popstate', () => {
            const params = new URLSearchParams(window.location.search);
            const appId = params.get('game');
            if (appId) {
                showGameDetail(appId, false);
            } else {
                // Visszat√©r√©s a kezd≈ëoldalra (grid n√©zet)
                const detailView = document.getElementById('detail-view');
                const gamesGrid = document.getElementById('games-grid');
                const summaryBox = document.getElementById('summary-box');
                const gridSort = document.getElementById('grid-sort-controls');

                if (detailView) detailView.classList.remove('active');
                if (gamesGrid) gamesGrid.classList.remove('hidden');
                if (summaryBox) summaryBox.classList.remove('hidden');
                if (gridSort) gridSort.classList.remove('hidden');
            }
        });
    </script>
    <script>
      const hubBtn = document.getElementById('hub-button');
      if (hubBtn) {
        hubBtn.addEventListener('click', () => {
          window.location.href = 'hub.html';
        });
      }
    </script>
  </body>
</html>
